<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ—¶é—´é€‰æ‹©å™¨æµ‹è¯•</title>
    <link rel="stylesheet" href="/src/styles/main.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #1C1C1E;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }
        .test-container {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }
        .test-button {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        .test-button:hover {
            background: #0056CC;
        }
        .debug-info {
            background: #2C2C2E;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: left;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ¥Š æ—¶é—´é€‰æ‹©å™¨æµ‹è¯•</h1>
        <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•æ—¶é—´é€‰æ‹©å™¨åŠŸèƒ½</p>
        
        <button class="test-button" onclick="testTimePicker('prepare')">æµ‹è¯• PREPARE</button>
        <button class="test-button" onclick="testTimePicker('round')">æµ‹è¯• ROUND</button>
        <button class="test-button" onclick="testTimePicker('warning')">æµ‹è¯• WARNING</button>
        <button class="test-button" onclick="testTimePicker('rest')">æµ‹è¯• REST</button>
        
        <div class="debug-info" id="debug-info">
            <h3>ğŸ” è°ƒè¯•ä¿¡æ¯</h3>
            <div id="debug-content">ç­‰å¾…æµ‹è¯•...</div>
        </div>
    </div>

    <!-- æ—¶é—´é€‰æ‹©å™¨æ¨¡æ€æ¡† -->
    <div id="time-adjustment-modal" class="modal-overlay" style="display: none;">
        <div class="time-adjustment-content">
            <!-- é¡¶éƒ¨æ˜¾ç¤ºåŒº -->
            <section class="time-display-section">
                <div class="phase-time-card">
                    <h2 id="phase-title" class="phase-title">PREPARE</h2>
                    <div id="current-time-display" class="time-display-large">00:10</div>
                </div>
            </section>

            <!-- é¢„è®¾æŒ‰é’®åŒº -->
            <section class="preset-buttons-section">
                <div class="preset-buttons-row" id="preset-buttons">
                    <button class="preset-time-btn" data-time="10">00:10</button>
                    <button class="preset-time-btn" data-time="20">00:20</button>
                    <button class="preset-time-btn" data-time="60">01:00</button>
                </div>
            </section>

            <!-- æ—¶é—´æ»šè½®é€‰æ‹©å™¨ -->
            <section class="time-picker-section">
                <div class="time-picker-container">
                    <div class="picker-column">
                        <div class="picker-label">mins</div>
                        <div class="picker-wheel" id="minutes-wheel">
                            <div class="picker-items" id="minutes-items">
                                <!-- åŠ¨æ€ç”Ÿæˆ 0-59 åˆ†é’Ÿ -->
                            </div>
                        </div>
                    </div>
                    <div class="picker-column">
                        <div class="picker-label">secs</div>
                        <div class="picker-wheel" id="seconds-wheel">
                            <div class="picker-items" id="seconds-items">
                                <!-- åŠ¨æ€ç”Ÿæˆ 0-59 ç§’ -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç¡®è®¤æŒ‰é’® -->
            <section class="modal-actions">
                <button id="time-done-btn" class="done-button">DONE</button>
            </section>
        </div>
    </div>

    <script type="module">
        import { TimePicker } from '/src/components/TimePicker.js';
        
        // åˆ›å»ºå…¨å±€å®ä¾‹
        let timePicker = null;
        let debugElement = document.getElementById('debug-content');
        
        function updateDebug(message) {
            const timestamp = new Date().toLocaleTimeString();
            debugElement.innerHTML += `<div>[${timestamp}] ${message}</div>`;
            console.log(message);
        }
        
        function testTimePicker(phase) {
            updateDebug(`ğŸ¯ å¼€å§‹æµ‹è¯• ${phase} æ—¶é—´é€‰æ‹©å™¨`);
            
            if (!timePicker) {
                updateDebug('ğŸ—ï¸ åˆ›å»º TimePicker å®ä¾‹...');
                timePicker = new TimePicker(document.body);
                timePicker.init();
                
                // ç›‘å¬æ—¶é—´æ›´æ–°äº‹ä»¶
                document.addEventListener('timeUpdated', (e) => {
                    updateDebug(`âœ… æ—¶é—´å·²æ›´æ–°: ${e.detail.phase} = ${e.detail.time} (${e.detail.seconds}ç§’)`);
                });
                
                updateDebug('âœ… TimePicker åˆ›å»ºå®Œæˆ');
            }
            
            // æµ‹è¯•æ˜¾ç¤º
            const testTimes = {
                prepare: '00:10',
                round: '01:30',
                warning: '00:05',
                rest: '00:30'
            };
            
            const currentTime = testTimes[phase] || '00:30';
            updateDebug(`ğŸ“± æ˜¾ç¤ºæ—¶é—´é€‰æ‹©å™¨: ${phase} = ${currentTime}`);
            
            timePicker.show(phase, currentTime);
            
            // æ£€æŸ¥DOMå…ƒç´ ç”Ÿæˆæƒ…å†µ
            setTimeout(() => {
                const minutesItems = document.getElementById('minutes-items');
                const secondsItems = document.getElementById('seconds-items');
                
                updateDebug(`ğŸ” DOMæ£€æŸ¥ç»“æœ:`);
                updateDebug(`  - minutes-items å­˜åœ¨: ${!!minutesItems}`);
                updateDebug(`  - seconds-items å­˜åœ¨: ${!!secondsItems}`);
                updateDebug(`  - minutes-items å­å…ƒç´ æ•°: ${minutesItems?.children.length || 0}`);
                updateDebug(`  - seconds-items å­å…ƒç´ æ•°: ${secondsItems?.children.length || 0}`);
                updateDebug(`  - minutes-items å¯è§: ${minutesItems?.offsetHeight > 0}`);
                updateDebug(`  - seconds-items å¯è§: ${secondsItems?.offsetHeight > 0}`);
                
                if (minutesItems?.children.length > 0) {
                    updateDebug(`  - ç¬¬ä¸€ä¸ªåˆ†é’Ÿé¡¹å†…å®¹: "${minutesItems.children[0].textContent}"`);
                    updateDebug(`  - ç¬¬ä¸€ä¸ªåˆ†é’Ÿé¡¹ç±»å: "${minutesItems.children[0].className}"`);
                }
                
                if (secondsItems?.children.length > 0) {
                    updateDebug(`  - ç¬¬ä¸€ä¸ªç§’é’Ÿé¡¹å†…å®¹: "${secondsItems.children[0].textContent}"`);
                    updateDebug(`  - ç¬¬ä¸€ä¸ªç§’é’Ÿé¡¹ç±»å: "${secondsItems.children[0].className}"`);
                }
            }, 500);
        }
        
        // æš´éœ²åˆ°å…¨å±€ä½œç”¨åŸŸ
        window.testTimePicker = testTimePicker;
        
        updateDebug('ğŸš€ æµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
    </script>
</body>
</html>