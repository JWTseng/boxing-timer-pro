<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»åº”ç”¨é¢œè‰²è¯Šæ–­</title>
    <style>
        body {
            font-family: monospace;
            background: #1a1a1a;
            color: white;
            padding: 20px;
        }
        .diagnostic {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
        }
        .color-box {
            display: inline-block;
            width: 50px;
            height: 30px;
            margin: 5px;
            border: 1px solid #fff;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <h1>ğŸ” ä¸»åº”ç”¨é¢œè‰²è¯Šæ–­å·¥å…·</h1>
    
    <div class="diagnostic">
        <h3>æ£€æµ‹ä¸»åº”ç”¨é¡µé¢ (iframe)</h3>
        <iframe src="/" width="100%" height="300" style="border: 1px solid #ccc;"></iframe>
    </div>
    
    <div class="diagnostic">
        <h3>CSSå˜é‡å€¼å®æ—¶è¯»å–</h3>
        <div id="css-vars-main"></div>
    </div>
    
    <div class="diagnostic">
        <h3>time-tagæŒ‰é’®è®¡ç®—åæ ·å¼</h3>
        <div id="computed-styles"></div>
    </div>
    
    <button onclick="diagnoseColors()" style="background: #007AFF; color: white; border: none; padding: 10px 20px; border-radius: 6px; margin: 10px;">
        ğŸš€ å¼€å§‹è¯Šæ–­
    </button>
    
    <script>
        function diagnoseColors() {
            const iframe = document.querySelector('iframe');
            
            // ç­‰å¾…iframeåŠ è½½å®Œæˆ
            iframe.onload = function() {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    const iframeWindow = iframe.contentWindow;
                    
                    // è¯»å–CSSå˜é‡å€¼
                    const cssVarsDiv = document.getElementById('css-vars-main');
                    const computedDiv = document.getElementById('computed-styles');
                    
                    const phases = ['prepare', 'round', 'warning', 'rest'];
                    let cssVarsHTML = '<h4>ä¸»åº”ç”¨CSSå˜é‡å€¼:</h4>';
                    let computedHTML = '<h4>ä¸»åº”ç”¨æŒ‰é’®å®é™…æ ·å¼:</h4>';
                    
                    phases.forEach(phase => {
                        // è·å–CSSå˜é‡å€¼
                        const cssVar = iframeWindow.getComputedStyle(iframeDoc.documentElement).getPropertyValue(`--color-${phase}`).trim();
                        cssVarsHTML += `<div>--color-${phase}: <strong>${cssVar}</strong> <div class="color-box" style="background: ${cssVar};"></div></div>`;
                        
                        // è·å–æŒ‰é’®å®é™…æ ·å¼
                        const button = iframeDoc.getElementById(`${phase}-time`);
                        if (button) {
                            const computed = iframeWindow.getComputedStyle(button);
                            const bg = computed.backgroundColor;
                            const color = computed.color;
                            computedHTML += `<div>${phase}-timeæŒ‰é’®: èƒŒæ™¯=${bg}, æ–‡å­—=${color} <div class="color-box" style="background: ${bg};"></div></div>`;
                        } else {
                            computedHTML += `<div>${phase}-timeæŒ‰é’®: æœªæ‰¾åˆ°</div>`;
                        }
                    });
                    
                    cssVarsDiv.innerHTML = cssVarsHTML;
                    computedDiv.innerHTML = computedHTML;
                    
                    // æ£€æŸ¥æ˜¯å¦æœ‰ç‰¹æ®Šæ¨¡å¼å¯ç”¨
                    const bodyClasses = iframeDoc.body.className;
                    if (bodyClasses) {
                        cssVarsDiv.innerHTML += `<div><strong>Body classes:</strong> ${bodyClasses}</div>`;
                    }
                    
                } catch (error) {
                    document.getElementById('css-vars-main').innerHTML = `<div style="color: red;">é”™è¯¯: ${error.message}</div>`;
                }
            };
            
            // å¼ºåˆ¶é‡æ–°åŠ è½½iframe
            iframe.src = iframe.src;
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¯Šæ–­
        setTimeout(diagnoseColors, 1000);
    </script>
</body>
</html>