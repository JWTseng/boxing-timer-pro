<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>颜色一致性测试 - Boxing Timer Pro</title>
    <link rel="stylesheet" href="./src/styles/main.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a1a, #2d2d30);
            color: white;
            margin: 0;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .color-comparison {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .color-item {
            text-align: center;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }
        .color-sample {
            width: 100%;
            height: 60px;
            border-radius: 8px;
            margin: 10px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }
        .test-btn {
            background: #007AFF;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            font-weight: bold;
        }
        .test-result {
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-weight: bold;
        }
        .pass { background: #34C759; color: white; }
        .fail { background: #FF3B30; color: white; }
        .info { background: #007AFF; color: white; }
        
        /* 模拟主界面按钮样式 */
        .mock-time-tag {
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: bold;
            margin: 5px;
            border: none;
            cursor: pointer;
            font-family: var(--font-family-mono, monospace);
        }
        .mock-time-tag.prepare { background: var(--color-prepare); color: #000000; }
        .mock-time-tag.round { background: var(--color-round); color: #000000; }
        .mock-time-tag.warning { background: var(--color-warning); color: #000000; }
        .mock-time-tag.rest { background: var(--color-rest); color: #FFFFFF; }
        
        /* 模拟时间设置页面样式 */
        .mock-phase-card {
            padding: 20px;
            border-radius: 12px;
            margin: 10px;
            text-align: center;
            font-weight: bold;
        }
        .mock-phase-card.prepare { background: var(--color-prepare); color: #000000; }
        .mock-phase-card.round { background: var(--color-round); color: #000000; }
        .mock-phase-card.warning { background: var(--color-warning); color: #000000; }
        .mock-phase-card.rest { background: var(--color-rest); color: #FFFFFF; }
        
        h1, h2 { color: #007AFF; }
        .variable-display {
            font-family: Monaco, monospace;
            background: rgba(0, 0, 0, 0.3);
            padding: 10px;
            border-radius: 6px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🎨 颜色一致性完整测试</h1>
        
        <div class="test-section">
            <h2>📊 测试控制</h2>
            <button class="test-btn" onclick="runColorConsistencyTest()">🚀 运行颜色一致性测试</button>
            <button class="test-btn" onclick="showColorVariables()">🔍 显示CSS变量值</button>
            <button class="test-btn" onclick="simulateUserFlow()">👆 模拟用户点击流程</button>
            <div id="test-results"></div>
        </div>

        <div class="test-section">
            <h2>🎯 颜色对比测试</h2>
            <p>左侧：主界面按钮颜色 | 右侧：时间设置页面颜色</p>
            
            <div class="color-comparison">
                <div class="color-item">
                    <h3>PREPARE 阶段</h3>
                    <div class="color-sample mock-time-tag prepare">00:10</div>
                    <div class="color-sample mock-phase-card prepare">设置页面</div>
                    <div class="variable-display" id="prepare-vars"></div>
                </div>
                
                <div class="color-item">
                    <h3>ROUND 阶段</h3>
                    <div class="color-sample mock-time-tag round">02:00</div>
                    <div class="color-sample mock-phase-card round">设置页面</div>
                    <div class="variable-display" id="round-vars"></div>
                </div>
                
                <div class="color-item">
                    <h3>WARNING 阶段</h3>
                    <div class="color-sample mock-time-tag warning">00:10</div>
                    <div class="color-sample mock-phase-card warning">设置页面</div>
                    <div class="variable-display" id="warning-vars"></div>
                </div>
                
                <div class="color-item">
                    <h3>REST 阶段</h3>
                    <div class="color-sample mock-time-tag rest">00:45</div>
                    <div class="color-sample mock-phase-card rest">设置页面</div>
                    <div class="variable-display" id="rest-vars"></div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>🧪 自动化测试结果</h2>
            <div id="automated-test-results">
                <p>点击"运行颜色一致性测试"开始...</p>
            </div>
        </div>
    </div>

    <script>
        // 获取CSS变量的实际值
        function getCSSVariable(variable) {
            return getComputedStyle(document.documentElement).getPropertyValue(variable).trim();
        }

        // 运行颜色一致性测试
        function runColorConsistencyTest() {
            const results = document.getElementById('automated-test-results');
            results.innerHTML = '<h3>🔄 测试进行中...</h3>';
            
            const phases = ['prepare', 'round', 'warning', 'rest'];
            let testResults = [];
            let passedTests = 0;
            let totalTests = 0;
            
            phases.forEach(phase => {
                totalTests++;
                
                // 获取CSS变量值
                const cssVarValue = getCSSVariable(`--color-${phase}`);
                
                // 获取实际渲染的背景色
                const mockButton = document.querySelector(`.mock-time-tag.${phase}`);
                const mockCard = document.querySelector(`.mock-phase-card.${phase}`);
                
                const buttonBg = getComputedStyle(mockButton).backgroundColor;
                const cardBg = getComputedStyle(mockCard).backgroundColor;
                
                // 比较颜色是否一致
                const isConsistent = buttonBg === cardBg;
                if (isConsistent) passedTests++;
                
                testResults.push({
                    phase: phase.toUpperCase(),
                    cssVar: cssVarValue || '未定义',
                    buttonColor: buttonBg,
                    cardColor: cardBg,
                    consistent: isConsistent
                });
            });
            
            // 生成测试报告
            let reportHTML = `<h3>📊 测试结果: ${passedTests}/${totalTests} 通过</h3>`;
            
            testResults.forEach(result => {
                const statusClass = result.consistent ? 'pass' : 'fail';
                const statusText = result.consistent ? '✅ 一致' : '❌ 不一致';
                
                reportHTML += `
                    <div class="test-result ${statusClass}">
                        <strong>${result.phase}</strong>: ${statusText}<br>
                        CSS变量: ${result.cssVar}<br>
                        按钮颜色: ${result.buttonColor}<br>
                        设置页颜色: ${result.cardColor}
                    </div>
                `;
            });
            
            if (passedTests === totalTests) {
                reportHTML += '<div class="test-result pass">🎉 所有阶段颜色完全一致！修复成功！</div>';
            } else {
                reportHTML += '<div class="test-result fail">⚠️ 发现颜色不一致问题，需要进一步修复</div>';
            }
            
            results.innerHTML = reportHTML;
        }

        // 显示CSS变量值
        function showColorVariables() {
            const phases = ['prepare', 'round', 'warning', 'rest'];
            
            phases.forEach(phase => {
                const element = document.getElementById(`${phase}-vars`);
                const cssValue = getCSSVariable(`--color-${phase}`);
                element.innerHTML = `
                    --color-${phase}: ${cssValue || '未定义'}<br>
                    实际渲染: ${getComputedStyle(document.querySelector(`.mock-time-tag.${phase}`)).backgroundColor}
                `;
            });
        }

        // 模拟用户点击流程
        function simulateUserFlow() {
            alert('🎮 模拟用户流程:\n1. 用户看到绿色ROUND按钮\n2. 点击按钮进入时间设置\n3. 时间设置页面应该显示相同的绿色\n\n查看上方对比，确认颜色是否一致！');
        }

        // 页面加载时自动显示变量值
        document.addEventListener('DOMContentLoaded', () => {
            showColorVariables();
        });
    </script>
</body>
</html>